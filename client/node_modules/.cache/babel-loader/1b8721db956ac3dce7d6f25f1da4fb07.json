{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aishwarya\\\\Desktop\\\\PRACTICE\\\\newwexpo\\\\expo - Copy\\\\client\\\\src\\\\components\\\\DashBoard\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport styles from \"./styles.module.css\";\nimport Footer from \"../footer/index\";\nimport Pie from \"../piechart/Pie\";\nimport Line from \"../Linegraph/Line\";\nimport Navigation from \"../NavBar/index\";\nimport Bar from \"../Bargraph/bargraph\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Main = () => {\n  _s();\n\n  const [incomes, setIncomes] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [expenses, setExpenses] = useState([]);\n  const [budgets, setBudgets] = useState([]);\n  const [selectedBudget, setSelectedBudget] = useState(null); // State to track selected budget\n  // Updated base API URL with /api prefix\n\n  const apiUrl = \"http://localhost:8080\"; // Helper to get the auth headers from localStorage\n\n  const getAuthHeaders = () => {\n    const token = localStorage.getItem(\"token\");\n    return {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `Bearer ${token}`\n    };\n  };\n\n  useEffect(() => {\n    getItems();\n    fetchExpenses();\n    fetchBudgets();\n  }, []); // Fetch all budget plans for the authenticated user\n\n  const fetchBudgets = async () => {\n    try {\n      const res = await fetch(`${apiUrl}/api/budgetplan`, {\n        headers: getAuthHeaders()\n      });\n      if (!res.ok) throw new Error(\"Failed to fetch budget plans\");\n      const data = await res.json();\n      setBudgets(data);\n    } catch (err) {\n      setError(err.message);\n    }\n  }; // Fetch expenses from backend with auth headers\n\n\n  const fetchExpenses = () => {\n    fetch(`${apiUrl}/api/expense`, {\n      method: \"GET\",\n      headers: getAuthHeaders()\n    }).then(res => res.json()).then(data => setExpenses(data)).catch(() => setError(\"Failed to fetch expenses\"));\n  }; // Fetch incomes for the authenticated user\n\n\n  const getItems = () => {\n    fetch(`${apiUrl}/income`, {\n      method: \"GET\",\n      headers: getAuthHeaders()\n    }).then(res => res.json()).then(data => setIncomes(data)).catch(() => setError(\"Failed to fetch incomes\"));\n  };\n\n  const totalIncome = incomes.reduce((sum, item) => sum + item.Amount, 0);\n  const totalExpense = expenses.reduce((sum, item) => sum + item.amount, 0);\n  const remainingBalance = totalIncome - totalExpense; // Filter expenses based on the selected budget\n\n  const filteredExpenses = selectedBudget ? expenses.filter(expense => expense.expense === selectedBudget.name) : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.main_container,\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: styles.dashboardHeader,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"An overview of your financial status\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: styles.overview,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.summaryCard,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Total Income\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.num,\n            children: [\"\\u20B9\", totalIncome]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.summaryCard,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Total Expense\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.num2,\n            children: [\"\\u20B9\", totalExpense]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.summaryCard,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Remaining Balance\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.num3,\n            children: [\"\\u20B9\", remainingBalance]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: styles.chartsSection,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.pie,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Expense Distribution\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Pie, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.chartWrapper,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Budget Breakdown\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Bar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.chartWrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Income vs Expense Trend\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Line, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.showBudget,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"My Budget Plans\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.error_msg,\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.budgetGrid,\n        children: budgets.map(plan => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.budgetCard,\n          onClick: () => setSelectedBudget(plan),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.budgetHeader,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.icon,\n              children: plan.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.budgetTitle,\n              children: plan.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.amount,\n              children: [\"\\u20B9\", plan.total]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [plan.items, \" Item(s)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.progressBar,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.progress,\n              style: {\n                width: plan.total > 0 ? `${plan.spent / plan.total * 100}%` : \"0%\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.budgetInfo,\n            children: [\"\\u20B9\", plan.spent, \" Spent | \\u20B9\", plan.total - plan.spent, \" Remaining\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 15\n          }, this)]\n        }, plan._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), selectedBudget && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.filteredExpenses,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Expenses for \", selectedBudget.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: styles.table,\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Type\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Expense Source\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Amount\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Reference\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: filteredExpenses.map(expense => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: expense.expenseType\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: expense.expense\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [\"\\u20B9\", expense.amount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: expense.reference || \"N/A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: new Date(expense.date).toLocaleDateString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 19\n            }, this)]\n          }, expense._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.foot,\n      children: /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Main, \"itawiPzDJa+pNKAD0WfvkNYfB7M=\");\n\n_c = Main;\nexport default Main;\n\nvar _c;\n\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"sources":["C:/Users/Aishwarya/Desktop/PRACTICE/newwexpo/expo - Copy/client/src/components/DashBoard/index.jsx"],"names":["useEffect","useState","styles","Footer","Pie","Line","Navigation","Bar","Main","incomes","setIncomes","error","setError","expenses","setExpenses","budgets","setBudgets","selectedBudget","setSelectedBudget","apiUrl","getAuthHeaders","token","localStorage","getItem","getItems","fetchExpenses","fetchBudgets","res","fetch","headers","ok","Error","data","json","err","message","method","then","catch","totalIncome","reduce","sum","item","Amount","totalExpense","amount","remainingBalance","filteredExpenses","filter","expense","name","main_container","dashboardHeader","overview","summaryCard","num","num2","num3","chartsSection","pie","chartWrapper","showBudget","error_msg","budgetGrid","map","plan","budgetCard","budgetHeader","icon","budgetTitle","total","items","progressBar","progress","width","spent","budgetInfo","_id","table","expenseType","reference","Date","date","toLocaleDateString","foot"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport styles from \"./styles.module.css\";\nimport Footer from \"../footer/index\";\nimport Pie from \"../piechart/Pie\";\nimport Line from \"../Linegraph/Line\";\nimport Navigation from \"../NavBar/index\";\nimport Bar from \"../Bargraph/bargraph\";\n\nconst Main = () => {\n  const [incomes, setIncomes] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [expenses, setExpenses] = useState([]);\n  const [budgets, setBudgets] = useState([]);\n  const [selectedBudget, setSelectedBudget] = useState(null); // State to track selected budget\n\n  // Updated base API URL with /api prefix\n  const apiUrl = \"http://localhost:8080\";\n\n  // Helper to get the auth headers from localStorage\n  const getAuthHeaders = () => {\n    const token = localStorage.getItem(\"token\");\n    return {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `Bearer ${token}`,\n    };\n  };\n\n  useEffect(() => {\n    getItems();\n    fetchExpenses();\n    fetchBudgets();\n  }, []);\n\n  // Fetch all budget plans for the authenticated user\n  const fetchBudgets = async () => {\n    try {\n      const res = await fetch(`${apiUrl}/api/budgetplan`, { headers: getAuthHeaders() });\n      if (!res.ok) throw new Error(\"Failed to fetch budget plans\");\n      const data = await res.json();\n      setBudgets(data);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  // Fetch expenses from backend with auth headers\n  const fetchExpenses = () => {\n    fetch(`${apiUrl}/api/expense`, { method: \"GET\", headers: getAuthHeaders() })\n      .then((res) => res.json())\n      .then((data) => setExpenses(data))\n      .catch(() => setError(\"Failed to fetch expenses\"));\n  };\n\n  // Fetch incomes for the authenticated user\n  const getItems = () => {\n    fetch(`${apiUrl}/income`, { method: \"GET\", headers: getAuthHeaders() })\n      .then((res) => res.json())\n      .then((data) => setIncomes(data))\n      .catch(() => setError(\"Failed to fetch incomes\"));\n  };\n\n  const totalIncome = incomes.reduce((sum, item) => sum + item.Amount, 0);\n  const totalExpense = expenses.reduce((sum, item) => sum + item.amount, 0);\n  const remainingBalance = totalIncome - totalExpense; \n\n  // Filter expenses based on the selected budget\n  const filteredExpenses = selectedBudget \n    ? expenses.filter(expense => expense.expense === selectedBudget.name)\n    : [];\n\n  return (\n    <div>\n      <Navigation />\n      <div className={styles.main_container}>\n        {/* Dashboard Header */}\n        <header className={styles.dashboardHeader}>\n          <h1>Dashboard</h1>\n          <p>An overview of your financial status</p>\n        </header>\n\n        {/* Overview Section */}\n        <section className={styles.overview}>\n          <div className={styles.summaryCard}>\n            <h2>Total Income</h2>\n            <p className={styles.num}>₹{totalIncome}</p>\n          </div>\n          <div className={styles.summaryCard}>\n            <h2>Total Expense</h2>\n            <p className={styles.num2}>₹{totalExpense}</p>\n          </div>\n          <div className={styles.summaryCard}>\n            <h2>Remaining Balance</h2>\n            <p className={styles.num3}>₹{remainingBalance}</p>\n          </div>\n        </section>\n\n        {/* Charts Section */}\n        <section className={styles.chartsSection}>\n          <div className={styles.pie}>\n            <h2>Expense Distribution</h2>\n            <Pie />\n          </div>\n          \n          <div className={styles.chartWrapper}>\n            <h2>Budget Breakdown</h2>\n            <Bar />\n          </div>\n        </section>\n      </div>\n      <div className={styles.chartWrapper}>\n            <h2>Income vs Expense Trend</h2>\n            <Line />\n          </div>\n      {/* Budget Plans Section */}\n      <div className={styles.showBudget}>\n        <h2>My Budget Plans</h2>\n        {error && <div className={styles.error_msg}>{error}</div>}\n        <div className={styles.budgetGrid}>\n          {budgets.map((plan) => (\n            <div key={plan._id} className={styles.budgetCard} onClick={() => setSelectedBudget(plan)}>\n              <div className={styles.budgetHeader}>\n                <span className={styles.icon}>{plan.icon}</span>\n                <span className={styles.budgetTitle}>{plan.name}</span>\n                <span className={styles.amount}>₹{plan.total}</span>\n              </div>\n              <p>{plan.items} Item(s)</p>\n              <div className={styles.progressBar}>\n                <div\n                  className={styles.progress}\n                  style={{ width: plan.total > 0 ? `${(plan.spent / plan.total) * 100}%` : \"0%\" }}\n                ></div>\n              </div>\n              <p className={styles.budgetInfo}>\n              ₹{plan.spent} Spent | ₹{plan.total - plan.spent} Remaining\n              </p>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Display Filtered Expenses */}\n      {selectedBudget && (\n        <div className={styles.filteredExpenses}>\n          <h2>Expenses for {selectedBudget.name}</h2>\n          <table className={styles.table}>\n            <thead>\n              <tr>\n                <th>Type</th>\n                <th>Expense Source</th>\n                <th>Amount</th>\n                <th>Reference</th>\n                <th>Date</th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredExpenses.map((expense) => (\n                <tr key={expense._id}>\n                  <td>{expense.expenseType}</td>\n                  <td>{expense.expense}</td>\n                  <td>₹{expense.amount}</td>\n                  <td>{expense.reference || \"N/A\"}</td>\n                  <td>{new Date(expense.date).toLocaleDateString()}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n\n      <div className={styles.foot}>\n        <Footer />\n      </div>\n    </div>\n  );\n};\n\nexport default Main;"]},"metadata":{},"sourceType":"module"}