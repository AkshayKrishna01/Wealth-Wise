{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aishwarya\\\\Desktop\\\\PRACTICE\\\\newwexpo\\\\expo - Copy\\\\client\\\\src\\\\components\\\\DashBoard\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport styles from \"./styles.module.css\";\nimport Footer from \"../footer/index\";\nimport Pie from \"../piechart/Pie\";\nimport Line from \"../Linegraph/Line\";\nimport Navigation from \"../NavBar/index\";\nimport Bar from \"../Bargraph/bargraph\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Main = () => {\n  _s();\n\n  const [incomes, setIncomes] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [expenses, setExpenses] = useState([]);\n  const [budgets, setBudgets] = useState([]); // Updated base API URL with /api prefix\n\n  const apiUrl = \"http://localhost:8080\"; // Helper to get the auth headers from localStorage\n\n  const getAuthHeaders = () => {\n    const token = localStorage.getItem(\"token\");\n    return {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `Bearer ${token}`\n    };\n  };\n\n  useEffect(() => {\n    getItems();\n    fetchExpenses();\n    fetchBudgets();\n  }, []); // Fetch all budget plans for the authenticated user\n\n  const fetchBudgets = async () => {\n    try {\n      const res = await fetch(`${apiUrl}/api/budgetplan`, {\n        headers: getAuthHeaders()\n      });\n      if (!res.ok) throw new Error(\"Failed to fetch budget plans\");\n      const data = await res.json();\n      setBudgets(data);\n    } catch (err) {\n      setError(err.message);\n    }\n  }; // Fetch expenses from backend with auth headers\n\n\n  const fetchExpenses = () => {\n    fetch(`${apiUrl}/api/expense`, {\n      method: \"GET\",\n      headers: getAuthHeaders()\n    }).then(res => res.json()).then(data => setExpenses(data)).catch(() => setError(\"Failed to fetch expenses\"));\n  }; // Fetch incomes for the authenticated user\n\n\n  const getItems = () => {\n    fetch(`${apiUrl}/income`, {\n      method: \"GET\",\n      headers: getAuthHeaders()\n    }).then(res => res.json()).then(data => setIncomes(data)).catch(() => setError(\"Failed to fetch incomes\"));\n  };\n\n  const totalIncome = incomes.reduce((sum, item) => sum + item.Amount, 0);\n  const totalExpense = expenses.reduce((sum, item) => sum + item.amount, 0);\n  const remainingBalance = totalIncome - totalExpense;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.main_container,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.con,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.piemon,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.money,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.Total,\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: [\"Total Income: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: styles.num,\n                  children: [\"$\", totalIncome]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 74,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 73,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: [\"Total Expense: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: styles.num2,\n                  children: [\"$\", totalExpense]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 77,\n                  columnNumber: 34\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 76,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.remain,\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: [\"Remaining: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: styles.num3,\n                  children: [\"$\", remainingBalance]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 30\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.piechart,\n          children: /*#__PURE__*/_jsxDEV(Pie, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 44\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.line,\n          children: /*#__PURE__*/_jsxDEV(Line, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 40\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.line,\n          children: /*#__PURE__*/_jsxDEV(Bar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 40\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.showBudget,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"My Budget Plans\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.error_msg,\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.budgetGrid,\n        children: budgets.map(plan => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.budgetCard,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.budgetHeader,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.icon,\n              children: plan.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.budgetTitle,\n              children: plan.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.amount,\n              children: [\"$\", plan.total]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [plan.items, \" Item(s)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.progressBar,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.progress,\n              style: {\n                width: plan.total > 0 ? `${plan.spent / plan.total * 100}%` : \"0%\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.budgetInfo,\n            children: [\"$\", plan.spent, \" Spent | $\", plan.total - plan.spent, \" Remaining\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 15\n          }, this)]\n        }, plan._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.foot,\n      children: /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 36\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Main, \"xQQWO2Gpx+D+bjrVvhOq1VAk+5A=\");\n\n_c = Main;\nexport default Main;\n\nvar _c;\n\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"sources":["C:/Users/Aishwarya/Desktop/PRACTICE/newwexpo/expo - Copy/client/src/components/DashBoard/index.jsx"],"names":["useEffect","useState","styles","Footer","Pie","Line","Navigation","Bar","Main","incomes","setIncomes","error","setError","expenses","setExpenses","budgets","setBudgets","apiUrl","getAuthHeaders","token","localStorage","getItem","getItems","fetchExpenses","fetchBudgets","res","fetch","headers","ok","Error","data","json","err","message","method","then","catch","totalIncome","reduce","sum","item","Amount","totalExpense","amount","remainingBalance","main_container","con","piemon","money","Total","num","num2","remain","num3","piechart","line","showBudget","error_msg","budgetGrid","map","plan","budgetCard","budgetHeader","icon","budgetTitle","name","total","items","progressBar","progress","width","spent","budgetInfo","_id","foot"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport styles from \"./styles.module.css\";\nimport Footer from \"../footer/index\";\nimport Pie from \"../piechart/Pie\";\nimport Line from \"../Linegraph/Line\";\nimport Navigation from \"../NavBar/index\";\nimport Bar from \"../Bargraph/bargraph\";\n\nconst Main = () => {\n  const [incomes, setIncomes] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [expenses, setExpenses] = useState([]);\n  const [budgets, setBudgets] = useState([]);\n  \n  // Updated base API URL with /api prefix\n  const apiUrl = \"http://localhost:8080\";\n\n  // Helper to get the auth headers from localStorage\n  const getAuthHeaders = () => {\n    const token = localStorage.getItem(\"token\");\n    return {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `Bearer ${token}`,\n    };\n  };\n\n  useEffect(() => {\n    getItems();\n    fetchExpenses();\n    fetchBudgets();\n  }, []);\n\n  // Fetch all budget plans for the authenticated user\n  const fetchBudgets = async () => {\n    try {\n      const res = await fetch(`${apiUrl}/api/budgetplan`, { headers: getAuthHeaders() });\n      if (!res.ok) throw new Error(\"Failed to fetch budget plans\");\n      const data = await res.json();\n      setBudgets(data);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  // Fetch expenses from backend with auth headers\n  const fetchExpenses = () => {\n    fetch(`${apiUrl}/api/expense`, { method: \"GET\", headers: getAuthHeaders() })\n      .then((res) => res.json())\n      .then((data) => setExpenses(data))\n      .catch(() => setError(\"Failed to fetch expenses\"));\n  };\n\n  // Fetch incomes for the authenticated user\n  const getItems = () => {\n    fetch(`${apiUrl}/income`, { method: \"GET\", headers: getAuthHeaders() })\n      .then((res) => res.json())\n      .then((data) => setIncomes(data))\n      .catch(() => setError(\"Failed to fetch incomes\"));\n  };\n\n  const totalIncome = incomes.reduce((sum, item) => sum + item.Amount, 0);\n  const totalExpense = expenses.reduce((sum, item) => sum + item.amount, 0);\n  const remainingBalance = totalIncome - totalExpense; \n\n  return (\n    <div>\n      <Navigation />\n      <div className={styles.main_container}>\n        <div className={styles.con}>\n          <div className={styles.piemon}>\n            <div className={styles.money}>\n              <div className={styles.Total}>\n                <h2>\n                  Total Income: <span className={styles.num}>${totalIncome}</span>\n                </h2>\n                <h2>\n                  Total Expense: <span className={styles.num2}>${totalExpense}</span>\n                </h2>\n              </div>\n              <br />\n              <div className={styles.remain}>\n                <h2>\n                  Remaining: <span className={styles.num3}>${remainingBalance}</span>\n                </h2>\n              </div>\n            </div>\n          </div>\n          <div className={styles.piechart}><Pie /></div>\n          <br />\n          <div className={styles.line}><Line /></div>\n          <br />\n          <div className={styles.line}><Bar /></div>\n        </div>\n      </div>\n      <div className={styles.showBudget}>\n        <h2>My Budget Plans</h2>\n        {error && <div className={styles.error_msg}>{error}</div>}\n        <div className={styles.budgetGrid}>\n          {budgets.map((plan) => (\n            <div key={plan._id} className={styles.budgetCard}>\n              <div className={styles.budgetHeader}>\n                <span className={styles.icon}>{plan.icon}</span>\n                <span className={styles.budgetTitle}>{plan.name}</span>\n                <span className={styles.amount}>${plan.total}</span>\n              </div>\n              <p>{plan.items} Item(s)</p>\n              <div className={styles.progressBar}>\n                <div\n                  className={styles.progress}\n                  style={{ width: plan.total > 0 ? `${(plan.spent / plan.total) * 100}%` : \"0%\" }}\n                ></div>\n              </div>\n              <p className={styles.budgetInfo}>\n                ${plan.spent} Spent | ${plan.total - plan.spent} Remaining\n              </p>\n            </div>\n          ))}\n        </div>\n      </div>\n      <div className={styles.foot}><Footer /></div>\n\n    </div>\n\n  );\n};\n\nexport default Main;\n"]},"metadata":{},"sourceType":"module"}